<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Part 3: Using cowplot to construct multi-panel figures entirely via code • MultiPanelPlotsWithR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Part 3: Using cowplot to construct multi-panel figures entirely via code">
<meta property="og:description" content="MultiPanelPlotsWithR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MultiPanelPlotsWithR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/group-01_Fundamentals-data-wrangling-tidyverse.html">Part 1: Fundamentals of data wrangling in tidyverse</a>
    </li>
    <li>
      <a href="../articles/group-02_Piping-single-panel-ggplot-figs.html">Part 2: Piping and producing single-panel ggplot figures</a>
    </li>
    <li>
      <a href="../articles/group-03_Using-cowplot-multi-panel.html">Part 3: Using cowplot to construct multi-panel figures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/flightlab/MultiPanelPlotsWithR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Part 3: Using cowplot to construct multi-panel
figures entirely via code</h1>
                        <h4 data-toc-skip class="author">by Vikram B.
Baliga, Andrea Gaede and Shreeram Senthivasan</h4>
            
            <h4 data-toc-skip class="date">Last updated on 2022-09-23
12:18:54</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/flightlab/MultiPanelPlotsWithR/blob/HEAD/vignettes/group-03_Using-cowplot-multi-panel.Rmd" class="external-link"><code>vignettes/group-03_Using-cowplot-multi-panel.Rmd</code></a></small>
      <div class="hidden name"><code>group-03_Using-cowplot-multi-panel.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is Part 3 of 3 for an R workshop created for <a href="http://www.biology.ubc.ca/course-listing-2/#500level-4" class="external-link">BIOL
548L</a>, a graduate-level course taught at the University of British
Columbia.</p>
<p>When the workshop runs, we split students into three groups with
successively increasing levels of difficulty. <strong>To make sense of
what follows, we recommend working through (or at least looking at) <a href="https://flightlab.github.io/MultiPanelPlotsWithR/articles/group-01_Fundamentals-data-wrangling-tidyverse.html">Part
1’s vignette</a> and <a href="https://flightlab.github.io/MultiPanelPlotsWithR/articles/group-02_Piping-single-panel-ggplot-figs.html">Part
2’s vignette</a> .</strong></p>
<p>All code and contents of this vignette were written together by
Vikram B. Baliga, Andrea Gaede and Shreeram Senthivasan.</p>
</div>
<div class="section level2">
<h2 id="the-endgame-create-a-multi-panel-plot-entirely-via-code">The endgame: create a multi-panel plot entirely via code<a class="anchor" aria-label="anchor" href="#the-endgame-create-a-multi-panel-plot-entirely-via-code"></a>
</h2>
<p>Multi-panel plots can provide an elegant way to tell a visual story
that is driven by narrative. One example of this is to craft a figure
that (from top to bottom) first shows raw data, then how data are
processed and analyzed, and then ultimately delivers a strong
punchline.</p>
<p>We will use Figure 3 from Gaede et al. 2017 <a href="http://dx.doi.org/10.1016/j.cub.2016.11.041" class="external-link">Current Biology</a>
as an example. Although the original version of this figure was made via
creating individual plots in R and then stitching them together in Adobe
Illustrator, in this vignette <strong>we’ll provide code that will
create the entire figure.</strong></p>
<p>Here’s the original figure, as seen in the paper:</p>
<div class="figure">
<img src="gaedeetal_fig3.png" alt=""><p class="caption">Figure 3 from Gaede et al. 2017</p>
</div>
<p>This study examined how neurons in the lentiformis mesencephali (LM)
brain region of three species of birds respond to visual motion across
the retina. The species examined were Anna’s hummingbird (<em>Calypte
anna</em>), the pigeon (<em>Columba livia</em>), and the zebra finch
(<em>Taeniopygia guttata</em>).</p>
<p>This figure shows that in hummingbirds, these neurons respond to
faster visual motion speeds than those in zebra finches or pigeons. A
raw trace of neural spikes from a zebra finch is shown in panel A.
Panels B, C, and D show how the raw traces can be analyzed to determine
the firing rate of neurons, and how these firing rates vary with the
speed of the image the bird is seeing. Ultimately, E and F characterize
the distribution of firing rates for all three species and show that
hummingbirds’ LM neurons respond more to higher visual speeds than the
LMs of the other species.</p>
</div>
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<p>The specific learning objectives for this post are:</p>
<ol style="list-style-type: decimal">
<li>Plan a sequence of plots that support a declarative statement of a
result</li>
<li>Construct a multi-panel figure using <a href="https://github.com/wilkelab/cowplot" class="external-link"><code>cowplot</code></a>
</li>
<li>Evaluate which among a diversity of plotting options most
effectively communicates a logical argument</li>
</ol>
</div>
<div class="section level2">
<h2 id="package-loading-and-setup">Package loading and setup<a class="anchor" aria-label="anchor" href="#package-loading-and-setup"></a>
</h2>
<div class="section level3">
<h3 id="load-or-installload-packages">Load or install&amp;load packages<a class="anchor" aria-label="anchor" href="#load-or-installload-packages"></a>
</h3>
<p>We’ll first load packages that will be necessary. The
<code>package.check()</code> function below is designed to first see if
each package is already installed. If any aren’t, the function then
installs them from CRAN. Then all the packages are loaded.</p>
<p>The code block is modified from <a href="https://vbaliga.github.io/verify-that-r-packages-are-installed-and-loaded/" class="external-link">this
blog post</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Modified from: </span>
<span class="co">## https://vbaliga.github.io/verify-that-r-packages-are-installed-and-loaded/</span>

<span class="co">## First specify the packages of interest</span>
<span class="va">packages</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gapminder"</span>,
    <span class="st">"ggplot2"</span>,
    <span class="st">"tidyr"</span>,
    <span class="st">"dplyr"</span>,
    <span class="st">"tibble"</span>,
    <span class="st">"readr"</span>,
    <span class="st">"forcats"</span>,
    <span class="st">"readxl"</span>,
    <span class="st">"ggthemes"</span>,
    <span class="st">"magick"</span>,
    <span class="st">"grid"</span>,
    <span class="st">"cowplot"</span>,
    <span class="co"># ggmap and maps are optional; needed for creating maps</span>
    <span class="st">"ggmap"</span>,
    <span class="st">"maps"</span><span class="op">)</span>

<span class="co">## Now load or install&amp;load all packages</span>
<span class="va">package.check</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>
    <span class="va">packages</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="op">{</span>
      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
      <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">x</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>,
                         repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span>
        <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-sets">Data sets<a class="anchor" aria-label="anchor" href="#data-sets"></a>
</h3>
<p>You can get all data used in this vignette (and the other two
vignettes!) by downloading <a href="ADD%20NEW%20LINK%20HERE">this zip
file</a>.</p>
<div class="section level4">
<h4 id="prep-work-for-figure-legends">Prep work for figure legends:<a class="anchor" aria-label="anchor" href="#prep-work-for-figure-legends"></a>
</h4>
<p>In prep for creating the figure, we will use the code below to import
the bird head icons that appear in the legend of each panel. Please note
that these images were drawn beforehand and saved as PNG files.</p>
<p>We will also assign each species a distinct color and create colored
rectangles that will also be part of the panel legends.</p>
<p>When these lines run, nothing will be plotted. We’re simply importing
or creating these objects so that they’re loaded in the Environment.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Bird head icons</span>
<span class="va">icon_hb</span> <span class="op">&lt;-</span> <span class="st">"hummingbird.png"</span>
<span class="va">icon_zb</span> <span class="op">&lt;-</span> <span class="st">"zeebie.png"</span>
<span class="va">icon_pg</span> <span class="op">&lt;-</span> <span class="st">"pigeon.png"</span>

<span class="co">## Colors for the different birds</span>
<span class="va">col_hb</span> <span class="op">&lt;-</span> <span class="st">"#ED0080"</span>
<span class="va">col_zb</span> <span class="op">&lt;-</span> <span class="st">"#F48D00"</span>
<span class="va">col_pg</span> <span class="op">&lt;-</span> <span class="st">"#4AA4F2"</span>

<span class="co">## Rectangles within legends</span>
<span class="va">rect_hb</span>   <span class="op">&lt;-</span> <span class="fu">rectGrob</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col_hb</span><span class="op">)</span><span class="op">)</span>
<span class="va">rect_hb_t</span> <span class="op">&lt;-</span> <span class="fu">rectGrob</span><span class="op">(</span>
               width <span class="op">=</span> <span class="fl">2</span>,
               height <span class="op">=</span> <span class="fl">1</span>,
               gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col_hb</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
             <span class="op">)</span>
<span class="va">rect_zb</span>   <span class="op">&lt;-</span> <span class="fu">rectGrob</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span>
<span class="va">rect_zb_t</span> <span class="op">&lt;-</span> <span class="fu">rectGrob</span><span class="op">(</span>
               width <span class="op">=</span> <span class="fl">2</span>,
               height <span class="op">=</span> <span class="fl">1</span>,
               gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col_zb</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
             <span class="op">)</span>
<span class="va">rect_pg</span>   <span class="op">&lt;-</span> <span class="fu">rectGrob</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col_pg</span><span class="op">)</span><span class="op">)</span>
<span class="va">point_hb</span>  <span class="op">&lt;-</span> <span class="fu">pointsGrob</span><span class="op">(</span>
               x <span class="op">=</span> <span class="fl">0</span>,
               y <span class="op">=</span> <span class="fl">0</span>,
               pch <span class="op">=</span> <span class="fl">24</span>,
               size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, units <span class="op">=</span> <span class="st">"char"</span><span class="op">)</span>,
               gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col_hb</span><span class="op">)</span>
             <span class="op">)</span>
<span class="va">point_zb</span>  <span class="op">&lt;-</span> <span class="fu">pointsGrob</span><span class="op">(</span>
               x <span class="op">=</span> <span class="fl">0</span>,
               y <span class="op">=</span> <span class="fl">0</span>,
               pch <span class="op">=</span> <span class="fl">21</span>,
               size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, units <span class="op">=</span> <span class="st">"char"</span><span class="op">)</span>,
               gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col_zb</span><span class="op">)</span>
             <span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="first-create-and-save-panels-as-separate-ggplot-objects">First, create and save panels as separate <code>ggplot</code>
objects<a class="anchor" aria-label="anchor" href="#first-create-and-save-panels-as-separate-ggplot-objects"></a>
</h2>
<p>We will first create each panel individually. To save space, we’ll
hide the code that generates each plot. To see the code for each plot
that follows, please see <a href="https://flightlab.github.io/MultiPanelPlotsWithR/articles/group-02_Piping-single-panel-ggplot-figs.html">Part
2’s vignette</a>.</p>
<div class="section level4">
<h4 id="figure-3-panel-a">Figure 3 Panel A:<a class="anchor" aria-label="anchor" href="#figure-3-panel-a"></a>
</h4>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/panel_A-1.png" width="336"></p>
</div>
<div class="section level3">
<h3 id="figure-3-panel-b">Figure 3 Panel B:<a class="anchor" aria-label="anchor" href="#figure-3-panel-b"></a>
</h3>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/panel_B-1.png" width="336"></p>
</div>
<div class="section level3">
<h3 id="figure-3-panel-c">Figure 3 Panel C:<a class="anchor" aria-label="anchor" href="#figure-3-panel-c"></a>
</h3>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/panel_C-1.png" width="336"></p>
</div>
<div class="section level3">
<h3 id="figure-3-panel-d">Figure 3 Panel D:<a class="anchor" aria-label="anchor" href="#figure-3-panel-d"></a>
</h3>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/panel_D-1.png" width="336"></p>
</div>
<div class="section level3">
<h3 id="figure-3-panel-e">Figure 3 Panel E:<a class="anchor" aria-label="anchor" href="#figure-3-panel-e"></a>
</h3>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/panel_E-1.png" width="432"></p>
</div>
<div class="section level3">
<h3 id="figure-3-panel-f">Figure 3 Panel F:<a class="anchor" aria-label="anchor" href="#figure-3-panel-f"></a>
</h3>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/panel_F-1.png" width="432"></p>
</div>
</div>
<div class="section level2">
<h2 id="a-quick-intro-to-cowplot">A quick intro to cowplot<a class="anchor" aria-label="anchor" href="#a-quick-intro-to-cowplot"></a>
</h2>
<p>We’ll go over <code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">cowplot::plot_grid()</a></code> basics:</p>
<ul>
<li>Multiple panels can be combined via
<code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">cowplot::plot_grid()</a></code>
</li>
<li>Each panel should be saved as a separate <code>ggplot</code> object
beforehand and then each will be fed in as an argument to
<code>plot_grid()</code>
</li>
<li>Panels can be annotated and labeled</li>
<li>
<code>draw_image()</code> &amp; <code>draw_grob()</code> can also be
used with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> and <code>plot_grid()</code>
</li>
</ul>
<p><strong>Plot objects can be added sequentially</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_B</span>, <span class="va">fig_C</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/add_plots_basic-1.png" width="700"></p>
<p><strong>By default, additional panels are initially added within the
same row.</strong><br><code>plot_grid()</code> then tends to prefer to have <code>ncol</code>
= <code>nrow</code> as best as possible. I’ll create an example by
pasting <code>fig_B</code> over and over again. Each panel will be
numbered so you can track how plots are added sequentially within
<code>plot_grid()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_B</span>, <span class="va">fig_B</span>, <span class="va">fig_B</span>,
          labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/sequential_adding-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_B</span>, <span class="va">fig_B</span>, <span class="va">fig_B</span>, <span class="va">fig_B</span>,
          labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/sequential_adding-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_B</span>, <span class="va">fig_B</span>, <span class="va">fig_B</span>, <span class="va">fig_B</span>, <span class="va">fig_B</span>,
          labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/sequential_adding-3.png" width="700"></p>
<p><strong>This looks okay, but we may prefer to have the plots arranged
in one column.</strong><br>
Let’s first just focus on panels E and F.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_E</span>, <span class="va">fig_F</span>,
          ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/plot_grid_ncol-1.png" width="700"></p>
<p><strong>Cowplot also allows you to add labels to panels as you’d see
in a journal article.</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_E</span>, <span class="va">fig_F</span>,
          ncol <span class="op">=</span> <span class="fl">1</span>,
          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>,<span class="st">"F"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/plot_grid_labels-1.png" width="700"></p>
<p><strong>See the arguments of <code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">cowplot::plot_grid()</a></code> to see
how labels can be adjusted.</strong> We’ll adjust the size and
(temporarily) change to a serif font.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_E</span>, <span class="va">fig_F</span>,
          ncol <span class="op">=</span> <span class="fl">1</span>,
          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>,<span class="st">"F"</span><span class="op">)</span>,
          label_size <span class="op">=</span> <span class="fl">40</span>,
          label_fontfamily <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/plot_grid_label_aes-1.png" width="700"></p>
<p>This looks horrible, but we’re using extreme values here to emphasize
what is being adjusted.</p>
</div>
<div class="section level2">
<h2 id="now-start-assemble-sets-of-panels-for-each-section-of-fig-3">Now start assemble sets of panels for each section of Fig 3<a class="anchor" aria-label="anchor" href="#now-start-assemble-sets-of-panels-for-each-section-of-fig-3"></a>
</h2>
<p>The layout of the figure is complex; <code>nrows</code> and
<code>ncols</code> can’t be set easily. Luckily we can build sets of
panels together, save each one, then stitch it all together at the
end.</p>
<p><strong>Let’s start with panels E and F.</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cow_EF</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_E</span>, <span class="va">fig_F</span>,
                    ncol <span class="op">=</span> <span class="fl">1</span>,
                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>,<span class="st">"F"</span><span class="op">)</span>,
                    label_size <span class="op">=</span> <span class="fl">18</span>,
                    label_fontfamily <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span>
<span class="va">cow_EF</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/cow_EF-1.png" width="700"></p>
<p><strong>For panel A, we’ll adjust the padding around the
margin.</strong><br>
Within the argument <code>plot.margin</code>, the order is top, right,
bottom, left; think TRouBLe (T,R,B,L)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_A</span> <span class="op">&lt;-</span> <span class="va">fig_A</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="fl">0</span>, <span class="fl">5.5</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span>
<span class="va">cow_A</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">fig_A</span>,
                   rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.07</span>, <span class="fl">0.93</span><span class="op">)</span>,
                   nrow <span class="op">=</span> <span class="fl">1</span>,
                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">""</span><span class="op">)</span>,
                   label_size <span class="op">=</span> <span class="fl">18</span>,
                   label_fontfamily <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span>
<span class="va">cow_A</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/cow_A-1.png" width="700"></p>
<p><strong>Panels B and C</strong><br>
When combining B and C, we should note that C has an x-axis label but B
does not. Therefore, we will add blank plots (<code>NULL</code>) as
padding and then adjust the relative heights to fit things comfortably.
We still need to supply 4 labels, so “” will be used for blank
plots.</p>
<p>One neat trick is that using a negative number within
<code>rel_heights</code> reduces space between plots (or elements). We
can use this to reduce the gap between panels if we don’t like how
<code>cowplot</code> handles things by default.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cow_BC</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">fig_B</span>, <span class="cn">NULL</span>, <span class="va">fig_C</span>,
                    <span class="co"># A negative rel_height shrinks space between elements</span>
                    rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">0.15</span>, <span class="fl">1</span><span class="op">)</span>,
                    ncol <span class="op">=</span> <span class="fl">1</span>,
                    label_y <span class="op">=</span> <span class="fl">1.07</span>,
                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>,<span class="st">"B"</span>,<span class="st">""</span>,<span class="st">"C"</span><span class="op">)</span>,
                    label_size <span class="op">=</span> <span class="fl">18</span>,
                    label_fontfamily <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span>
<span class="va">cow_BC</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/cow_BC-1.png" width="384"></p>
<p><strong>Panel D</strong><br>
Similarly, with panel D, we’ll add a <code>NULL</code> object to the
cowplot and adjust the relative heights to the proportions we’d
like.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_D</span> <span class="op">&lt;-</span> <span class="va">fig_D</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number of speed bins above threshold    "</span><span class="op">)</span>
<span class="va">cow_D</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">fig_D</span>,
                    rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1.85</span><span class="op">)</span>,
                    ncol <span class="op">=</span> <span class="fl">1</span>,
                    label_y <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.07</span> <span class="op">/</span><span class="fl">1.85</span>,
                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>,<span class="st">"D"</span><span class="op">)</span>,
                    label_size <span class="op">=</span> <span class="fl">18</span>,
                    label_fontfamily <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 770 rows containing non-finite values (stat_boxplot).</span>
<span class="co">#&gt; Warning: Removed 770 rows containing missing values (geom_point).</span>
<span class="va">cow_D</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/cow_D-1.png" width="384"></p>
<p><strong>You can cowplot multiple cowplots</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cow_BCD</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span><span class="va">cow_BC</span>, <span class="va">cow_D</span>,
                     rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,
                      nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">cow_BCD</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/cow_BCD-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="combine-all-the-sets-of-panels-together">Combine all the sets of panels together<a class="anchor" aria-label="anchor" href="#combine-all-the-sets-of-panels-together"></a>
</h2>
<p>It may help to specify the dimensions of the plot window to ensure
that the plot is made with correct overall proportions:</p>
<p>For Windows users, this should work:
<code>try(dev.off(), silent = TRUE)</code>
<code>dev.new(width = 8.5, height = 11, units = "in")</code> (You may
need to run the <code>dev.new...</code> line more than once)</p>
<p>For Mac users, <code>qartz()</code> seems to be the way to go. E.g.:
<code>quartz(width = 8.5, height = 11)</code></p>
<p><strong>Now for the plot itself:</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cow_A2F</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span><span class="va">cow_A</span>, <span class="cn">NULL</span>, <span class="va">cow_BCD</span>, <span class="va">cow_EF</span>,
          ncol <span class="op">=</span> <span class="fl">1</span>,
          <span class="co"># A negative rel_height shrinks space between elements</span>
          rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="fl">2.5</span>, <span class="fl">3</span><span class="op">)</span>,
          label_size <span class="op">=</span> <span class="fl">18</span>,
          label_fontfamily <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span>
<span class="va">cow_A2F</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/cowAtoF-1.png" width="816"></p>
</div>
<div class="section level2">
<h2 id="the-final-step-add-icons-to-the-multi-panel-plot">The final step: Add icons to the multi-panel plot<a class="anchor" aria-label="anchor" href="#the-final-step-add-icons-to-the-multi-panel-plot"></a>
</h2>
<p>The bird heads and other legend elements are conspicuously absent.
The <code><a href="https://wilkelab.org/cowplot/reference/draw_image.html" class="external-link">cowplot::draw_image()</a></code> function allows for an image to
be placed on the canvas, which we’ll use for the bird heads.</p>
<p>Similarly, <code><a href="https://wilkelab.org/cowplot/reference/draw_grob.html" class="external-link">cowplot::draw_grob()</a></code> places grobs (GRaphical
OBjects). We’ll use this to add in colored rectangles for the
legends.</p>
<p>Each image’s (or <code>grob</code>’s) location is specified with x-
and y- coordinates. Each runs from 0 to 1, with (0,0) being the lower
left corner of the canvas.</p>
<p>At the moment, vectorization of the code you see below doesn’t seem
possible. It’s a bit tedious (ok, VERY tedious. And un-tidy!) but it
works!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cow_final</span> <span class="op">&lt;-</span> <span class="fu">ggdraw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_plot</span><span class="op">(</span><span class="va">cow_A2F</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Hummingbird heads</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_hb</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.445</span>, y <span class="op">=</span>  <span class="fl">0.445</span>, scale <span class="op">=</span> <span class="fl">0.060</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel A</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_hb</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.350</span>, y <span class="op">=</span>  <span class="fl">0.305</span>, scale <span class="op">=</span> <span class="fl">0.060</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel B</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_hb</span>, x <span class="op">=</span>  <span class="fl">0.445</span>, y <span class="op">=</span>  <span class="fl">0.280</span>, scale <span class="op">=</span> <span class="fl">0.060</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel D</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_hb</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.280</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.073</span>, scale <span class="op">=</span> <span class="fl">0.060</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel E</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_hb</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.280</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.313</span>, scale <span class="op">=</span> <span class="fl">0.060</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel F</span>
  <span class="co"># Zebra finch heads</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_zb</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.360</span>, y <span class="op">=</span>  <span class="fl">0.135</span>, scale <span class="op">=</span> <span class="fl">0.052</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel C</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_zb</span>, x <span class="op">=</span>  <span class="fl">0.435</span>, y <span class="op">=</span>  <span class="fl">0.250</span>, scale <span class="op">=</span> <span class="fl">0.052</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel D</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_zb</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.290</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.100</span>, scale <span class="op">=</span> <span class="fl">0.052</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel E</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_zb</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.290</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.340</span>, scale <span class="op">=</span> <span class="fl">0.052</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel F</span>
  <span class="co"># Pigeon head</span>
  <span class="fu">draw_image</span><span class="op">(</span>image <span class="op">=</span> <span class="va">icon_pg</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.290</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.130</span>, scale <span class="op">=</span> <span class="fl">0.055</span><span class="op">)</span> <span class="op">+</span><span class="co"># Panel E</span>
  <span class="co"># Boxes</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">rect_hb_t</span>, x <span class="op">=</span>  <span class="fl">0.390</span>, y <span class="op">=</span>  <span class="fl">0.280</span>, scale <span class="op">=</span> <span class="fl">0.010</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">rect_zb_t</span>, x <span class="op">=</span>  <span class="fl">0.390</span>, y <span class="op">=</span>  <span class="fl">0.253</span>, scale <span class="op">=</span> <span class="fl">0.010</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">rect_hb</span>,   x <span class="op">=</span> <span class="op">-</span><span class="fl">0.340</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.073</span>, scale <span class="op">=</span> <span class="fl">0.010</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">rect_zb</span>,   x <span class="op">=</span> <span class="op">-</span><span class="fl">0.340</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.099</span>, scale <span class="op">=</span> <span class="fl">0.010</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">rect_pg</span>,   x <span class="op">=</span> <span class="op">-</span><span class="fl">0.340</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.125</span>, scale <span class="op">=</span> <span class="fl">0.010</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">rect_hb</span>,   x <span class="op">=</span> <span class="op">-</span><span class="fl">0.340</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.313</span>, scale <span class="op">=</span> <span class="fl">0.010</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">rect_zb</span>,   x <span class="op">=</span> <span class="op">-</span><span class="fl">0.340</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.337</span>, scale <span class="op">=</span> <span class="fl">0.010</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Points</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">point_hb</span>,  x <span class="op">=</span>  <span class="fl">0.390</span>, y <span class="op">=</span>  <span class="fl">0.280</span>, scale <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_grob</span><span class="op">(</span>grob <span class="op">=</span> <span class="va">point_zb</span>,  x <span class="op">=</span>  <span class="fl">0.390</span>, y <span class="op">=</span>  <span class="fl">0.253</span>, scale <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>
<span class="va">cow_final</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/fig3_final-1.png" width="816"></p>
<p>And there you have it! <strong>We have recreated the entire figure –
including annotations, icons, and inserted images – all through
code.</strong></p>
<p>Thanks for reading!</p>
<p>🐢</p>
</div>
<div class="section level2">
<h2 id="appendix-saving-plots-using-photos-maps">Appendix: saving plots; using photos &amp; maps<a class="anchor" aria-label="anchor" href="#appendix-saving-plots-using-photos-maps"></a>
</h2>
<div class="section level3">
<h3 id="a1-saving-multi-panel-plots">A1: Saving multi-panel plots<a class="anchor" aria-label="anchor" href="#a1-saving-multi-panel-plots"></a>
</h3>
<p><code><a href="https://wilkelab.org/cowplot/reference/save_plot.html" class="external-link">cowplot::save_plot()</a></code> tends to work better with
multi-panel figures than <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code> does. You can specify
size (in inches) via the arguments <code>base_height</code> and
<code>base_width</code> within <code>save_plot()</code>.</p>
<p><strong>For example:</strong>
<code>save_plot("Gaedeetal_Fig3.svg", cow_final, base_height = 11, base_width = 8.5)</code></p>
</div>
<div class="section level3">
<h3 id="a2-using-photographs-with-ggplotcowplot">A2: Using photographs with ggplot/cowplot<a class="anchor" aria-label="anchor" href="#a2-using-photographs-with-ggplotcowplot"></a>
</h3>
<p>Often, you may opt to add a photograph as its own panel.</p>
<p><strong>Here’s a quick example:</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">photo</span> <span class="op">&lt;-</span> <span class="st">"./photo.jpg"</span></code></pre></div>
<p><strong>Now create a ggplot object that features only the
image.</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">photo_panel</span> <span class="op">&lt;-</span> <span class="fu">ggdraw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">draw_image</span><span class="op">(</span><span class="va">photo</span>, scale <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="va">photo_panel</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/photo_panel-1.png" width="700"></p>
<p><strong>Now cowplot it!</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_F</span>, <span class="va">photo_panel</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/photo_plot-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="a3-using-maps-with-ggplotcowplot">A3: Using maps with ggplot/cowplot<a class="anchor" aria-label="anchor" href="#a3-using-maps-with-ggplotcowplot"></a>
</h3>
<p>Adding in maps can be useful to showing geographic trends. The
<code>maps</code> package allows for convenient plotting of (annotated)
maps with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.</p>
<p><strong>Quick example. Load the ‘world’ map:</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">map_data</a></span><span class="op">(</span><span class="st">"world"</span><span class="op">)</span></code></pre></div>
<p><strong>If you’d, for whatever reason, like to highlight certain
countries:</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># This outlines all countries in grey70</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>,
               fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Let's highlight some countries in dogdgerblue fill</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>,
               fill <span class="op">=</span> <span class="st">"dodgerblue"</span>, colour <span class="op">=</span> <span class="st">"black"</span>,
               data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chad"</span>, <span class="st">"China"</span>, <span class="st">"New Zealand"</span>,
                                              <span class="st">"Portugal"</span>, <span class="st">"Switzerland"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Nuke the theme for simplicity.</span>
  <span class="fu">theme_nothing</span><span class="op">(</span><span class="op">)</span>
<span class="va">fig_map</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/fig_map-1.png" width="700"></p>
<p><strong>This map can be added to a cowplot rather
easily:</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_map</span>, 
          <span class="va">photo_panel</span>, 
          <span class="va">fig_F</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="group-03_Using-cowplot-multi-panel_files/figure-html/map_image_plot-1.png" width="576"></p>
<p>That’s all for now. Have fun!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.vikram-baliga.com/" class="external-link">Vikram B. Baliga</a>, <a href="https://www.andreagaede.com/" class="external-link">Andrea Gaede</a>, <a href="https://www.zoology.ubc.ca/person/shreeram-senthivasan/" class="external-link">Shree Senthivasan</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Part 2: Piping and producing single-panel ggplot figures • MultiPanelPlotsWithR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Part 2: Piping and producing single-panel ggplot figures">
<meta property="og:description" content="MultiPanelPlotsWithR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MultiPanelPlotsWithR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/group-01_Fundamentals-data-wrangling-tidyverse.html">Part 1: Fundamentals of data wrangling in tidyverse</a>
    </li>
    <li>
      <a href="../articles/group-02_Piping-single-panel-ggplot-figs.html">Part 2: Piping and producing single-panel ggplot figures</a>
    </li>
    <li>
      <a href="../articles/group-03_Using-cowplot-multi-panel.html">Part 3: Using cowplot to construct multi-panel figures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/flightlab/MultiPanelPlotsWithR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Part 2: Piping and producing single-panel ggplot
figures</h1>
                        <h4 data-toc-skip class="author">by Vikram B.
Baliga, Andrea Gaede and Shreeram Senthivasan</h4>
            
            <h4 data-toc-skip class="date">Last updated on 2022-09-15
15:56:21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/flightlab/MultiPanelPlotsWithR/blob/HEAD/vignettes/group-02_Piping-single-panel-ggplot-figs.Rmd" class="external-link"><code>vignettes/group-02_Piping-single-panel-ggplot-figs.Rmd</code></a></small>
      <div class="hidden name"><code>group-02_Piping-single-panel-ggplot-figs.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is Part 2 of 3 for an R workshop created for <a href="http://www.biology.ubc.ca/course-listing-2/#500level-4" class="external-link">BIOL
548L</a>, a graduate-level course taught at the University of British
Columbia.</p>
<p>When the workshop runs, we split students into three groups with
successively increasing levels of difficulty. <strong>To make sense of
what follows, we recommend working through (or at least looking at) <a href="https://flightlab.github.io/MultiPanelPlotsWithR/articles/group-01_Fundamentals-data-wrangling-tidyverse.html">Part
1’s vignette</a>.</strong></p>
<p>The goal of Part 2’s vignette is to learn how to structure data to
produce single plots ready for presentations and publications</p>
<p>Part 3’s vignette (which we recommend going through only
<em>after</em> completing this page) can be found <a href="https://flightlab.github.io/MultiPanelPlotsWithR/articles/group-03_Using-cowplot-multi-panel.html">here</a>.</p>
<p>All code and contents of this vignette were written together by
Vikram B. Baliga, Andrea Gaede and Shreeram Senthivasan.</p>
<p>You can get all data used in this vignette (and the other two!) by
downloading <a href="https://github.com/flightlab/MultiPanelPlotsWithR/releases/download/v1.1.0/workshop_materials.zip" class="external-link">this
zip file</a>.</p>
</div>
<div class="section level2">
<h2 id="learning-objectives">Learning Objectives:<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Articulate the advantages of literate programming</li>
<li>Employ piping to restructure data for tidyverse</li>
<li>Describe the grammar of graphics that underlies plotting in
ggplot</li>
<li>Manipulate plots to improve clarity and maximize the data : ink
ratio</li>
</ol>
</div>
<div class="section level2">
<h2 id="load-or-installload-packages">Load or install&amp;load packages<a class="anchor" aria-label="anchor" href="#load-or-installload-packages"></a>
</h2>
<p>We’ll first load packages that will be necessary. The
<code>package.check()</code> function below is designed to first see if
each package is already installed. If any aren’t, the function then
installs them from CRAN. Then all the packages are loaded.</p>
<p>The code block is modified from <a href="https://vbaliga.github.io/verify-that-r-packages-are-installed-and-loaded/" class="external-link">this
blog post</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Modified from: </span>
<span class="co">## https://vbaliga.github.io/verify-that-r-packages-are-installed-and-loaded/</span>

<span class="co">## First specify the packages of interest</span>
<span class="va">packages</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gapminder"</span>,
    <span class="st">"ggplot2"</span>,
    <span class="st">"tidyr"</span>,
    <span class="st">"dplyr"</span>,
    <span class="st">"tibble"</span>,
    <span class="st">"readr"</span>,
    <span class="st">"forcats"</span>,
    <span class="st">"readxl"</span>,
    <span class="st">"ggthemes"</span>,
    <span class="st">"magick"</span>,
    <span class="st">"grid"</span>,
    <span class="st">"cowplot"</span>,
    <span class="co"># ggmap and maps are optional; needed for creating maps</span>
    <span class="st">"ggmap"</span>,
    <span class="st">"maps"</span><span class="op">)</span>

<span class="co">## Now load or install&amp;load all packages</span>
<span class="va">package.check</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>
    <span class="va">packages</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="op">{</span>
      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
      <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">x</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>,
                         repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span>
        <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="data-sets">Data sets<a class="anchor" aria-label="anchor" href="#data-sets"></a>
</h3>
<p>You can get all data used in this vignette (and the other two!) by
downloading <a href="ADD%20NEW%20LINK%20HERE">this zip file</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="what-is-literate-programming">What is literate programming?<a class="anchor" aria-label="anchor" href="#what-is-literate-programming"></a>
</h2>
<p>“Literate programming” rethinks the “grammar” of traditional code to
more closely resemble writing in a human language, like English.</p>
<p>The primary goal of literate programming is to move away from coding
“for computers” (ie, code that simplifies compilation) and instead to
write in a way that more resembles how we think.</p>
<p>In addition to making for much more readable code even with fewer
comments, a good literate coding language should make it easier for you
to translate ideas into code.</p>
<p>In the <code>tidyverse</code>, we will largely use the analogy of
variables as nouns and functions as verbs that operate on the nouns.</p>
<p>The main way we will make our code literate however is with the pipe:
<code>%&gt;%</code></p>
</div>
<div class="section level2">
<h2 id="what-is-a-pipe">What is a pipe?<a class="anchor" aria-label="anchor" href="#what-is-a-pipe"></a>
</h2>
<p>A pipe, or <code>%&gt;%</code>, is an operator that takes everything
on the left and plugs it into the function on the right.</p>
<p>In short: <code>x %&gt;% f(y)</code> is equivalent to
<code>f(x, y)</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># So:</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="va">continent</span> <span class="op">==</span> <span class="st">'Asia'</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 396 × 6</span></span>
<span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>952    28.8  8<span style="text-decoration: underline;">425</span>333      779.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>957    30.3  9<span style="text-decoration: underline;">240</span>934      821.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>962    32.0 10<span style="text-decoration: underline;">267</span>083      853.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>967    34.0 11<span style="text-decoration: underline;">537</span>966      836.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>972    36.1 13<span style="text-decoration: underline;">079</span>460      740.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>977    38.4 14<span style="text-decoration: underline;">880</span>372      786.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>982    39.9 12<span style="text-decoration: underline;">881</span>816      978.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>987    40.8 13<span style="text-decoration: underline;">867</span>957      852.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>992    41.7 16<span style="text-decoration: underline;">317</span>921      649.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>997    41.8 22<span style="text-decoration: underline;">227</span>415      635.</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 386 more rows</span></span>

<span class="co"># Can be re-written as:</span>
<span class="va">gapminder</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">continent</span> <span class="op">==</span> <span class="st">'Asia'</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 396 × 6</span></span>
<span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>952    28.8  8<span style="text-decoration: underline;">425</span>333      779.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>957    30.3  9<span style="text-decoration: underline;">240</span>934      821.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>962    32.0 10<span style="text-decoration: underline;">267</span>083      853.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>967    34.0 11<span style="text-decoration: underline;">537</span>966      836.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>972    36.1 13<span style="text-decoration: underline;">079</span>460      740.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>977    38.4 14<span style="text-decoration: underline;">880</span>372      786.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>982    39.9 12<span style="text-decoration: underline;">881</span>816      978.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>987    40.8 13<span style="text-decoration: underline;">867</span>957      852.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>992    41.7 16<span style="text-decoration: underline;">317</span>921      649.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Afghanistan Asia       <span style="text-decoration: underline;">1</span>997    41.8 22<span style="text-decoration: underline;">227</span>415      635.</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 386 more rows</span></span></code></pre></div>
<p>In RStudio you can use the shortcut <code>CTRL + SHIFT + M</code> (on
Windows) or <code>CMD + SHIFT + M</code> (on Mac) to insert a pipe</p>
</div>
<div class="section level2">
<h2 id="why-bother-with-pipes">Why bother with pipes?<a class="anchor" aria-label="anchor" href="#why-bother-with-pipes"></a>
</h2>
<p>To see how pipes can make code more readable, let’s translate this
cake recipe into pseudo R code:</p>
<ol style="list-style-type: decimal">
<li>Cream together sugar and butter</li>
<li>Beat in eggs and vanilla</li>
<li>Mix in flour and baking powder</li>
<li>Stir in milk</li>
<li>Bake</li>
<li>Frost</li>
</ol>
<p><strong>Saving Intermediate Steps:</strong><br>
One way you might approach coding this is by defining a lot of
variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">batter_1</span>   <span class="op">&lt;-</span> <span class="fu">cream</span><span class="op">(</span><span class="va">sugar</span>, <span class="va">butter</span><span class="op">)</span>  
<span class="va">batter_2</span>   <span class="op">&lt;-</span> <span class="fu">beat_in</span><span class="op">(</span><span class="va">batter_1</span>, <span class="va">eggs</span>, <span class="va">vanilla</span><span class="op">)</span>  
<span class="va">batter_3</span>   <span class="op">&lt;-</span> <span class="fu">mix_in</span><span class="op">(</span><span class="va">batter_2</span>, <span class="va">flour</span>, <span class="va">baking_powder</span><span class="op">)</span>  
<span class="va">batter_4</span>   <span class="op">&lt;-</span> <span class="fu">stir_in</span><span class="op">(</span><span class="va">batter_3</span>, <span class="va">milk</span><span class="op">)</span>  
<span class="va">cake</span>       <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">batter_3</span><span class="op">)</span>  
<span class="va">cake_final</span> <span class="op">&lt;-</span> <span class="fu">frost</span><span class="op">(</span><span class="va">cake</span><span class="op">)</span>  </code></pre></div>
<p>The info is all there, but there’s a lot of repetition and
opportunity for typos. You also have to jump back and forth between
lines to make sure you’re calling the right variables.</p>
<p>A similar approach would be to keep overwriting a single
variable:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">cream</span><span class="op">(</span><span class="va">sugar</span>, <span class="va">butter</span><span class="op">)</span>  
<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">beat_in</span><span class="op">(</span><span class="va">cake</span>, <span class="va">eggs</span>, <span class="va">vanilla</span><span class="op">)</span>  
<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">mix_in</span><span class="op">(</span><span class="va">cake</span>, <span class="va">flour</span>, <span class="va">baking_powder</span><span class="op">)</span>  
<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">stir_in</span><span class="op">(</span><span class="va">cake</span>, <span class="va">milk</span><span class="op">)</span>  
<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">cake</span><span class="op">)</span>  
<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">frost</span><span class="op">(</span><span class="va">cake</span><span class="op">)</span>  </code></pre></div>
<p>But it’s still not as clear as the original recipe…And if anything
goes wrong you have to re-run the whole pipeline.</p>
<p><strong>Function Composition:</strong><br>
If we don’t want to save intermediates, we can just do all the steps in
one line:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">frost</span><span class="op">(</span><span class="fu">bake</span><span class="op">(</span><span class="fu">stir_in</span><span class="op">(</span><span class="fu">mix_in</span><span class="op">(</span><span class="fu">beat_in</span><span class="op">(</span><span class="fu">cream</span><span class="op">(</span><span class="va">sugar</span>, <span class="va">butter</span><span class="op">)</span>, <span class="va">eggs</span>, <span class="va">vanilla</span><span class="op">)</span>, <span class="va">flour</span>, <span class="va">baking_powder</span><span class="op">)</span>, <span class="va">milk</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </code></pre></div>
<p>Or with better indentation:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">frost</span><span class="op">(</span>  
    <span class="fu">bake</span><span class="op">(</span>  
      <span class="fu">stir_in</span><span class="op">(</span>  
        <span class="fu">mix_in</span><span class="op">(</span>  
          <span class="fu">beat_in</span><span class="op">(</span>  
            <span class="fu">cream</span><span class="op">(</span><span class="va">sugar</span>, <span class="va">butter</span><span class="op">)</span>,  
            <span class="va">eggs</span>,  
            <span class="va">vanilla</span>  
          <span class="op">)</span>,  
          <span class="va">flour</span>, <span class="va">baking_powder</span>  
        <span class="op">)</span>,  
      <span class="va">milk</span><span class="op">)</span>  
    <span class="op">)</span>  
  <span class="op">)</span>  </code></pre></div>
<p>It’s pretty clear why this is no good</p>
</div>
<div class="section level2">
<h2 id="piping">Piping<a class="anchor" aria-label="anchor" href="#piping"></a>
</h2>
<p><strong>Now for the piping approach:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cake</span> <span class="op">&lt;-</span>  
    <span class="fu">cream</span><span class="op">(</span><span class="va">sugar</span>, <span class="va">butter</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  
    <span class="fu">beat_in</span><span class="op">(</span><span class="va">eggs</span>, <span class="va">vanilla</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  
    <span class="fu">mix_in</span><span class="op">(</span><span class="va">flour</span>, <span class="va">baking_powder</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  
    <span class="fu">stir_in</span><span class="op">(</span><span class="va">milk</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  
    <span class="fu">bake</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  
    <span class="fu">frost</span><span class="op">(</span><span class="op">)</span>  </code></pre></div>
<p>When you are reading code, you can replace pipes with the phrase “and
then.”</p>
<p>And remember, pipes just take everything on the left and plug it into
the function on the right. If you step through this code, this chunk is
exactly the same as the function composition example above, it’s just
written for people to read.</p>
<p>When you chain together multiple manipulations, piping makes it easy
to focus on what’s important at every step. One caveat is that you need
the first argument of every function in the pipe to be the object you
are manipulating. Tidyverse functions all follow this convention, as do
many other functions.</p>
<p><strong>Where do you find new verbs?</strong></p>
<p>The RStudio cheat sheets are a whole lot more useful once you start
piping – here are a few:</p>
<ul>
<li><p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf" class="external-link">Data
transformation</a></p></li>
<li><p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf" class="external-link">Data
import and restructuring</a></p></li>
<li><p><a href="https://www.rstudio.com/resources/cheatsheets/" class="external-link">Other
cheat sheets</a></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="some-prep-work-for-the-coding-part-of-the-lesson">Some prep work for the coding part of the lesson:<a class="anchor" aria-label="anchor" href="#some-prep-work-for-the-coding-part-of-the-lesson"></a>
</h2>
<p>In this section our main goal will be to reproduce as closely as
possible all the individual plots that make up Figure 3 in the <a href="https://www.cell.com/current-biology/fulltext/S0960-9822(16)31394-X" class="external-link">Gaede
et al. 2017 paper</a>.</p>
<p>The one exception to that will be the legends and icons, which are
easier to align and arrange when organizing the plots into a single
multipanel figure, which is left for Group 3.</p>
<p>Let’s start by opening up the paper and setting up some variables we
will be using throughout the plotting.</p>
<p><strong>Colours for the different birds</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col_hb</span> <span class="op">&lt;-</span> <span class="st">"#ED0080"</span>
<span class="va">col_zb</span> <span class="op">&lt;-</span> <span class="st">"#F48D00"</span>
<span class="va">col_pg</span> <span class="op">&lt;-</span> <span class="st">"#4AA4F2"</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="anatomy-of-a-ggplot">Anatomy of a ggplot<a class="anchor" aria-label="anchor" href="#anatomy-of-a-ggplot"></a>
</h2>
<p><code>ggplot2</code> is built around the idea of a “Grammar of
Graphics” – a way of describing (almost) any graphic.</p>
<p>There are three key components to any graphic under the Grammar of
Graphics:</p>
<ul>
<li>Data: the information to be conveyed</li>
<li>Geometries: the things you actually draw on the plot (lines, points,
polygons, etc…)</li>
<li>Aesthetic mapping: the connection between relevant parts of the data
and the aesthetics (size, colour, position, etc…) of the geometries</li>
</ul>
<p>Any ggplot you make will at the very minimum require these three
things and will usually look something like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">my_data</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">var1</span>, y <span class="op">=</span> <span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Or, equivalently:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">var1</span>, y <span class="op">=</span> <span class="va">var2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>But how do you know what geometries are available or what aesthetic
mappings you can use for each? Use the <a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf" class="external-link">plotting
with ggplot2 cheat sheet</a></p>
<p>Other possibly relevant componenets include:</p>
<ul>
<li>Coordinate systems (eg cartesian vs polar plots)</li>
<li>Scales (eg mapping specifc colours to groups)</li>
<li>Facets (subpanels of similar plots)</li>
</ul>
</div>
<div class="section level2">
<h2 id="build-a-boxplot-with-data-superimposed-figure-3-panel-d">Build a boxplot with data superimposed (Figure 3 Panel D):<a class="anchor" aria-label="anchor" href="#build-a-boxplot-with-data-superimposed-figure-3-panel-d"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3D_data.csv"</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">2400</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (1): species</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (2): perc_firing, num_bins</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>

<span class="co"># Visualize data</span>
<span class="va">data_D</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,400 × 3</span></span>
<span class="co">#&gt;    species perc_firing num_bins</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> calan          0.5         4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> calan          0.55        4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> calan          0.6         4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> calan          0.65        4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> calan          0.7         3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> calan          0.75        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> calan          0.8         1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> calan          0.85        1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> calan          0.9         1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> calan          0.95        1</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 2,390 more rows</span></span></code></pre></div>
<p><strong>Let’s make a ggplot!</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p><strong>Add points:</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p><strong>Separate points:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'jitter'</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p><strong>Add summary statistics:</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'jitter'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p><strong>Fix x axis:</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3D_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    perc_firing <span class="op">=</span> <span class="va">perc_firing</span> <span class="op">*</span> <span class="fl">100</span>,
    perc_firing <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">perc_firing</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="co">## This will get rid of the annoying warnings</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">2400</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (1): species</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (2): perc_firing, num_bins</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span></code></pre></div>
<p><strong>Re-plot with new x:</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'jitter'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p><strong>Swap colour to fill:</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'jitter'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p><strong>Fix colours:</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># browseURL("http://www.sthda.com/english/wiki/ggplot2-point-shapes")</span>
<span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'jitter'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p><strong>De-emphasize boxplots, remove outliers</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, outlier.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">'jitter'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p><strong>Tune jitter:</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, outlier.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge</a></span><span class="op">(</span>jitter.height <span class="op">=</span> <span class="fl">0.3</span>, 
                                      jitter.width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p><strong>Titles and theming and save:</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_D</span> <span class="op">&lt;-</span> <span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, outlier.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge</a></span><span class="op">(</span>jitter.height <span class="op">=</span> <span class="fl">0.3</span>, 
                                      jitter.width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"Percent of maximum firing rate (threshold)"</span>,
      y <span class="op">=</span> <span class="st">"Number of speed bins above threshold"</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="co"># theme_bw()</span>
    <span class="co"># theme_light()</span>
    <span class="co"># theme_dark()</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">fig_D</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p><strong>Let’s create a theme:</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">theme_548</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,
      axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
      axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<p><strong>Let’s see what it looks like</strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_D</span> <span class="op">+</span> <span class="va">theme_548</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p><strong>Let’s create a theme:</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">theme_548</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
      <span class="co"># Text</span>
      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,
      axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
      axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span>,
      axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,
      <span class="co"># Axis line</span>
      axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
      axis.ticks.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="st">"pt"</span><span class="op">)</span>,
      <span class="co"># Legend</span>
      legend.position <span class="op">=</span> <span class="st">'none'</span>,
      <span class="co"># Background transparency</span>
        <span class="co"># Background of panel</span>
      panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>,
        <span class="co"># Background behind actual data points</span>
      plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>
    <span class="op">)</span>

<span class="va">fig_D</span> <span class="op">+</span> <span class="va">theme_548</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p><strong>Draw in x and y axes:</strong></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, outlier.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge</a></span><span class="op">(</span>jitter.height <span class="op">=</span> <span class="fl">0.3</span>, 
                                      jitter.width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"Percent of maximum firing rate (threshold)"</span>,
      y <span class="op">=</span> <span class="st">"Number of speed bins above threshold"</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="va">theme_548</span> <span class="op">+</span>
    <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html" class="external-link">geom_rangeframe</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p><strong>Draw in x and y axes:</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_D</span> <span class="op">&lt;-</span> <span class="va">data_D</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_firing</span>, y <span class="op">=</span> <span class="va">num_bins</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, outlier.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge</a></span><span class="op">(</span>jitter.height <span class="op">=</span> <span class="fl">0.3</span>, 
                                      jitter.width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"Percent of maximum firing rate (threshold)"</span>,
      y <span class="op">=</span> <span class="st">"Number of speed bins above threshold"</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="va">theme_548</span> <span class="op">+</span>
    <span class="fu">geom_rangeframe</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">0</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">2.5</span>, yend <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">fig_D</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="build-a-grouped-barplot-figure-3-panel-e">Build a grouped barplot (Figure 3 Panel E):<a class="anchor" aria-label="anchor" href="#build-a-grouped-barplot-figure-3-panel-e"></a>
</h2>
<p><strong>Visualize the data:</strong></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3E_data.csv"</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">3</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">16</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (16): 0.1, 0.24, 0.5, 1, 1.5, 2, 4, 8, 16, 24, 32, 48, 64, 80, 128, 256</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 16</span></span>
<span class="co">#&gt;   `0.1` `0.24`  `0.5`    `1`  `1.5`     `2`     `4`    `8`   `16`   `24`   `32`</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0 0.035<span style="text-decoration: underline;">7</span> 0.017<span style="text-decoration: underline;">9</span> 0      0      0.107   0.035<span style="text-decoration: underline;">7</span>  0.035<span style="text-decoration: underline;">7</span> 0.053<span style="text-decoration: underline;">6</span> 0.089<span style="text-decoration: underline;">3</span> 0.071<span style="text-decoration: underline;">4</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     0 0      0      0.018<span style="text-decoration: underline;">7</span> 0      0.009<span style="text-decoration: underline;">35</span> 0.009<span style="text-decoration: underline;">35</span> 0.093<span style="text-decoration: underline;">5</span> 0.168  0.121  0.187 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     0 0      0.094<span style="text-decoration: underline;">7</span> 0.052<span style="text-decoration: underline;">6</span> 0.010<span style="text-decoration: underline;">5</span> 0.126   0.126   0.084<span style="text-decoration: underline;">2</span> 0.147  0      0.147 </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 5 more variables: 48 &lt;dbl&gt;, 64 &lt;dbl&gt;, 80 &lt;dbl&gt;, 128 &lt;dbl&gt;, 256 &lt;dbl&gt;</span></span></code></pre></div>
<p><strong>Restructure data for plotting:</strong></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add the missing info</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3E_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hb"</span>, <span class="st">"zb"</span>, <span class="st">"pg"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">3</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">16</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (16): 0.1, 0.24, 0.5, 1, 1.5, 2, 4, 8, 16, 24, 32, 48, 64, 80, 128, 256</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 17</span></span>
<span class="co">#&gt;   `0.1` `0.24`  `0.5`    `1`  `1.5`     `2`     `4`    `8`   `16`   `24`   `32`</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0 0.035<span style="text-decoration: underline;">7</span> 0.017<span style="text-decoration: underline;">9</span> 0      0      0.107   0.035<span style="text-decoration: underline;">7</span>  0.035<span style="text-decoration: underline;">7</span> 0.053<span style="text-decoration: underline;">6</span> 0.089<span style="text-decoration: underline;">3</span> 0.071<span style="text-decoration: underline;">4</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     0 0      0      0.018<span style="text-decoration: underline;">7</span> 0      0.009<span style="text-decoration: underline;">35</span> 0.009<span style="text-decoration: underline;">35</span> 0.093<span style="text-decoration: underline;">5</span> 0.168  0.121  0.187 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     0 0      0.094<span style="text-decoration: underline;">7</span> 0.052<span style="text-decoration: underline;">6</span> 0.010<span style="text-decoration: underline;">5</span> 0.126   0.126   0.084<span style="text-decoration: underline;">2</span> 0.147  0      0.147 </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 6 more variables: 48 &lt;dbl&gt;, 64 &lt;dbl&gt;, 80 &lt;dbl&gt;, 128 &lt;dbl&gt;, 256 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   species &lt;chr&gt;</span></span>

<span class="co"># Pull the y-values down from the header</span>
<span class="va">data_E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3E_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hb"</span>, <span class="st">"zb"</span>, <span class="st">"pg"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">speed</span>, value <span class="op">=</span> <span class="va">prop</span>, <span class="op">-</span><span class="va">species</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">3</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">16</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (16): 0.1, 0.24, 0.5, 1, 1.5, 2, 4, 8, 16, 24, 32, 48, 64, 80, 128, 256</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="va">data_E</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 3</span></span>
<span class="co">#&gt;    species speed   prop</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hb      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> zb      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> pg      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hb      0.24  0.035<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> zb      0.24  0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> pg      0.24  0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hb      0.5   0.017<span style="text-decoration: underline;">9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> zb      0.5   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> pg      0.5   0.094<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hb      1     0     </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 38 more rows</span></span></code></pre></div>
<p><strong>Plot data:</strong></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_E</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># But wait, the x-axis and species are out of order!</span>
<span class="va">data_E</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 3</span></span>
<span class="co">#&gt;    species speed   prop</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hb      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> zb      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> pg      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hb      0.24  0.035<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> zb      0.24  0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> pg      0.24  0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hb      0.5   0.017<span style="text-decoration: underline;">9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> zb      0.5   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> pg      0.5   0.094<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hb      1     0     </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 38 more rows</span></span>

<span class="va">data_E</span> <span class="op">&lt;-</span> <span class="va">data_E</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    species <span class="op">=</span> <span class="fu">fct_relevel</span><span class="op">(</span><span class="va">species</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hb"</span>,<span class="st">"zb"</span>,<span class="st">"pg"</span><span class="op">)</span><span class="op">)</span>,
    speed <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="va">data_E</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 3</span></span>
<span class="co">#&gt;    species speed   prop</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hb      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> zb      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> pg      0.1   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hb      0.24  0.035<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> zb      0.24  0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> pg      0.24  0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hb      0.5   0.017<span style="text-decoration: underline;">9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> zb      0.5   0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> pg      0.5   0.094<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hb      1     0     </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 38 more rows</span></span></code></pre></div>
<p><strong>Plot data again!</strong></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_E</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Unstack columns and add black outline</span>
<span class="va">data_E</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">'dodge'</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-32-2.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Space out column groups, thin out the columns, thin the outline</span>
<span class="va">data_E</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.75</span>,
      size <span class="op">=</span> <span class="fl">0.2</span>,
      colour <span class="op">=</span> <span class="st">"black"</span>
    <span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-32-3.png" width="700"></p>
<p><strong>Pick colours, add labels, add theme:</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_E</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.75</span>,
      size <span class="op">=</span> <span class="fl">0.2</span>,
      colour <span class="op">=</span> <span class="st">"black"</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span>, <span class="va">col_pg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"Speed bins (degrees/s)"</span>,
      y <span class="op">=</span> <span class="st">"Proportion of LM\ncell population"</span>
    <span class="op">)</span><span class="op">+</span>
    <span class="va">theme_548</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p><strong>Fix x axis, add y axis line:</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_E</span> <span class="op">&lt;-</span> <span class="va">data_E</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Plot data</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.75</span>,
      size <span class="op">=</span> <span class="fl">0.2</span>,
      colour <span class="op">=</span> <span class="st">"black"</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="co"># Pick colours</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span>, <span class="va">col_pg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Text</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"Speed bins (degrees/s)"</span>,
      y <span class="op">=</span> <span class="st">"Proportion of LM\ncell population"</span>
    <span class="op">)</span><span class="op">+</span>
    <span class="co"># Theme</span>
    <span class="va">theme_548</span> <span class="op">+</span>
    <span class="co"># Axes</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
      axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
      axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_rangeframe</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span>
<span class="va">fig_E</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="build-a-line-plot-with-error-bars-and-other-graphical-features-figure-3-panel-b">Build a line plot with error bars and other graphical features
(Figure 3 Panel B):<a class="anchor" aria-label="anchor" href="#build-a-line-plot-with-error-bars-and-other-graphical-features-figure-3-panel-b"></a>
</h2>
<p><strong>Visualize data:</strong></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3B_data.csv"</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">239</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">23</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (23): trial, direction, speed, bin1, bin2, bin3, bin4, bin5, bin6, bin7,...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 239 × 23</span></span>
<span class="co">#&gt;    trial direction    speed  bin1  bin2  bin3  bin4  bin5  bin6  bin7  bin8</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       135   1.90   12.0   4.00  4.00  0     4.00  0     0     0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>       0     4.00  0     4.00  0     0     0     0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3       315  -<span style="color: #BB0000;">0.696</span>   0     4.00  0     0     0     0     4.00  0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>       0     0     0     0     0     4.00  0     0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5       135  -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>  0     0     0     4.00  0     0     0     0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>       0     0     0     0     0     0     0     0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7       135   0.821  16    24    16    28    36     8.00  8.00  8.00</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>       4.00  0     0     0     0     0     0     0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9       315   1.63    0     0     0     0     0     0     0     0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>       0     4.00 12     0     4.00  0     0     4.00</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 229 more rows, and 12 more variables: bin9 &lt;dbl&gt;, bin10 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   bin11 &lt;dbl&gt;, bin12 &lt;dbl&gt;, bin13 &lt;dbl&gt;, bin14 &lt;dbl&gt;, bin15 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   bin16 &lt;dbl&gt;, bin17 &lt;dbl&gt;, bin18 &lt;dbl&gt;, bin19 &lt;dbl&gt;, bin20 &lt;dbl&gt;</span></span></code></pre></div>
<p><strong>Gather all the bin data into one column:</strong></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3B_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">bin</span>, value <span class="op">=</span> <span class="va">count</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bin"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">239</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">23</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (23): trial, direction, speed, bin1, bin2, bin3, bin4, bin5, bin6, bin7,...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,780 × 5</span></span>
<span class="co">#&gt;    trial direction    speed bin   count</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       135   1.90   bin1  12.0 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3       315  -<span style="color: #BB0000;">0.696</span>  bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5       135  -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span> bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7       135   0.821  bin1  16   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   4.00</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9       315   1.63   bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 4,770 more rows</span></span></code></pre></div>
<p><strong>Group the data by trial, direction speed:</strong></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3B_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">bin</span>, value <span class="op">=</span> <span class="va">count</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bin"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trial</span>, <span class="va">direction</span>, <span class="va">speed</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">239</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">23</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (23): trial, direction, speed, bin1, bin2, bin3, bin4, bin5, bin6, bin7,...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,780 × 5</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   trial, direction, speed [239]</span></span>
<span class="co">#&gt;    trial direction    speed bin   count</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       135   1.90   bin1  12.0 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3       315  -<span style="color: #BB0000;">0.696</span>  bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5       135  -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span> bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7       135   0.821  bin1  16   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   4.00</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9       315   1.63   bin1   0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>      bin1   0   </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 4,770 more rows</span></span></code></pre></div>
<p><strong>Calculate firing rate for each trial:</strong></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3B_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">bin</span>, value <span class="op">=</span> <span class="va">count</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bin"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trial</span>, <span class="va">direction</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    raw_firing_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">239</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">23</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (23): trial, direction, speed, bin1, bin2, bin3, bin4, bin5, bin6, bin7,...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; `summarise()` has grouped output by 'trial', 'direction'. You can override using the `.groups` argument.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 239 × 4</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   trial, direction [239]</span></span>
<span class="co">#&gt;    trial direction    speed raw_firing_rate</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       135   1.90             2.00 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3       315  -<span style="color: #BB0000;">0.696</span>            0.800</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5       135  -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>           0.600</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7       135   0.821           11.4  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.200</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9       315   1.63             0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                1.20 </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 229 more rows</span></span></code></pre></div>
<p><strong>Finally let’s ungroup and store this unnormalized
data:</strong></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3B_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">bin</span>, value <span class="op">=</span> <span class="va">count</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bin"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trial</span>, <span class="va">direction</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    raw_firing_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">239</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">23</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (23): trial, direction, speed, bin1, bin2, bin3, bin4, bin5, bin6, bin7,...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; `summarise()` has grouped output by 'trial', 'direction'. You can override using the `.groups` argument.</span>
<span class="va">data_B_raw</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 239 × 4</span></span>
<span class="co">#&gt;    trial direction    speed raw_firing_rate</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       135   1.90             2.00 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3       315  -<span style="color: #BB0000;">0.696</span>            0.800</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5       135  -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>           0.600</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7       135   0.821           11.4  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.200</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9       315   1.63             0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                1.20 </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 229 more rows</span></span></code></pre></div>
<p><strong>Now we need to normalize the data:</strong></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First calculate a baseline</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">data_B_raw</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="co">#&gt;   trial direction    speed raw_firing_rate</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   234       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   235       315  -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>           4.00 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   236       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   237       135  -<span style="color: #BB0000;">0.696</span>            0.600</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   238       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                0.600</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   239       315   0.821            0.200</span>

<span class="va">data_B_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">==</span> <span class="st">'NaN'</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 119 × 4</span></span>
<span class="co">#&gt;    trial direction speed raw_firing_rate</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     2       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     4       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     6       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     8       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.200</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    10       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           1.20 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    12       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.600</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    14       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.800</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    16       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.6  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    18       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.200</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    20       <span style="color: #BB0000;">NaN</span>   <span style="color: #BB0000;">NaN</span>           0.400</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 109 more rows</span></span>

<span class="va">data_B_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">==</span> <span class="st">'NaN'</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">raw_firing_rate</span><span class="op">)</span>
<span class="co">#&gt;   [1]  0.400010  0.400010  0.000000  0.200005  1.200015  0.600015  0.800020</span>
<span class="co">#&gt;   [8]  0.600000  0.200005  0.400010  0.200005  1.000020  4.600060  1.800045</span>
<span class="co">#&gt;  [15]  2.200045  0.000000 11.000040  1.200030  1.400035  0.400010  1.600010</span>
<span class="co">#&gt;  [22]  0.600030  0.000000  0.000000  0.000000  0.200005  0.000000  0.000000</span>
<span class="co">#&gt;  [29]  0.200005  0.400010  0.200005  0.000000  0.200005  0.200005  0.600015</span>
<span class="co">#&gt;  [36]  0.000000  0.000000  1.600035  3.600060  0.200005  0.200000  0.200005</span>
<span class="co">#&gt;  [43]  0.800020  0.000000  0.400010  0.200005  0.800020  0.800020  0.800020</span>
<span class="co">#&gt;  [50]  0.200005  0.200000  0.600015  0.200005  0.600015  0.600015  0.000000</span>
<span class="co">#&gt;  [57]  0.200005  0.000000  0.200005  0.000000  0.000000  0.000000  0.000000</span>
<span class="co">#&gt;  [64]  0.000000  0.200005  0.400005  1.400020  0.000000  0.000000  0.000000</span>
<span class="co">#&gt;  [71]  0.000000 12.800070  0.000000  0.000000  0.000000  0.000000  1.600070</span>
<span class="co">#&gt;  [78]  0.400010  4.200115  1.200015  0.000000  0.000000  0.000000  0.200005</span>
<span class="co">#&gt;  [85]  0.000000  0.400010  0.400010  0.400010  0.200005  1.400035  0.400010</span>
<span class="co">#&gt;  [92]  0.200005  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000</span>
<span class="co">#&gt;  [99]  4.600050  0.200005  0.000000  0.400010  1.800045  0.600015  0.200005</span>
<span class="co">#&gt; [106]  0.000000  0.200005  0.200005  0.000000  0.000000  0.200005  0.000000</span>
<span class="co">#&gt; [113]  0.000000  0.200005  0.000000  0.400005  0.400010  0.000000  0.600015</span>

<span class="va">baseline</span> <span class="op">&lt;-</span> <span class="va">data_B_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">==</span> <span class="st">'NaN'</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">raw_firing_rate</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="va">mean</span>
<span class="va">baseline</span>
<span class="co">#&gt; [1] 0.6806833</span>

<span class="co"># Use the baseline to normalize the data</span>
<span class="va">data_B_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">!=</span> <span class="st">'NaN'</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    norm_firing_rate <span class="op">=</span> <span class="va">raw_firing_rate</span> <span class="op">-</span> <span class="va">baseline</span>,
    norm_firing_rate <span class="op">=</span> <span class="va">norm_firing_rate</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 120 × 5</span></span>
<span class="co">#&gt;    trial direction   speed raw_firing_rate norm_firing_rate</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       135  1.90             2.00           0.067<span style="text-decoration: underline;">6</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     3       315 -<span style="color: #BB0000;">0.696</span>            0.800          0.006<span style="text-decoration: underline;">11</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     5       135 -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>           0.600         -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">13</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     7       135  0.821           11.4            0.549  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     9       315  1.63             0             -<span style="color: #BB0000;">0.034</span><span style="color: #BB0000; text-decoration: underline;">9</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    11       135 -<span style="color: #BB0000;">0.401</span>            0.200         -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">6</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    13       315  1.90             0             -<span style="color: #BB0000;">0.034</span><span style="color: #BB0000; text-decoration: underline;">9</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    15       135  1.63            20.2            1      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    17       315 -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>           0.200         -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">6</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    19       135  1.13            13.2            0.641  </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 110 more rows</span></span></code></pre></div>
<p><strong>Next let’s find the mean and SE of firing rate across like
trials:</strong></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">!=</span> <span class="st">'NaN'</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    norm_firing_rate <span class="op">=</span> <span class="va">raw_firing_rate</span> <span class="op">-</span> <span class="va">baseline</span>,
    norm_firing_rate <span class="op">=</span> <span class="va">norm_firing_rate</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">direction</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    firing_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span>,
    sem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'direction'. You can override using the</span>
<span class="co">#&gt; `.groups` argument.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 4</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   direction [2]</span></span>
<span class="co">#&gt;    direction   speed firing_rate     sem</span>
<span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       135 -<span style="color: #BB0000;">0.696</span>      -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">5</span> 0.008<span style="text-decoration: underline;">32</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       135 -<span style="color: #BB0000;">0.401</span>      -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">6</span> 0.005<span style="text-decoration: underline;">61</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       135 -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>     -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">4</span> 0.007<span style="text-decoration: underline;">53</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       135  0.214      -<span style="color: #BB0000;">0.010</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.013<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       135  0.524       0.028<span style="text-decoration: underline;">7</span> 0.025<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       135  0.821       0.148  0.101  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       135  1.13        0.412  0.066<span style="text-decoration: underline;">1</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       135  1.30        0.578  0.090<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       135  1.43        0.654  0.057<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       135  1.63        0.717  0.081<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 14 more rows</span></span></code></pre></div>
<p><strong>Finally ungroup the data and convert direction to a
factor:</strong></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B</span> <span class="op">&lt;-</span> <span class="va">data_B_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">!=</span> <span class="st">'NaN'</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    norm_firing_rate <span class="op">=</span> <span class="va">raw_firing_rate</span> <span class="op">-</span> <span class="va">baseline</span>,
    norm_firing_rate <span class="op">=</span> <span class="va">norm_firing_rate</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">direction</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    firing_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span>,
    sem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">direction</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'direction'. You can override using the</span>
<span class="co">#&gt; `.groups` argument.</span>
<span class="va">data_B</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 4</span></span>
<span class="co">#&gt;    direction   speed firing_rate     sem</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 135       -<span style="color: #BB0000;">0.696</span>      -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">5</span> 0.008<span style="text-decoration: underline;">32</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 135       -<span style="color: #BB0000;">0.401</span>      -<span style="color: #BB0000;">0.024</span><span style="color: #BB0000; text-decoration: underline;">6</span> 0.005<span style="text-decoration: underline;">61</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 135       -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>     -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">4</span> 0.007<span style="text-decoration: underline;">53</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 135        0.214      -<span style="color: #BB0000;">0.010</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.013<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 135        0.524       0.028<span style="text-decoration: underline;">7</span> 0.025<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 135        0.821       0.148  0.101  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 135        1.13        0.412  0.066<span style="text-decoration: underline;">1</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 135        1.30        0.578  0.090<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 135        1.43        0.654  0.057<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 135        1.63        0.717  0.081<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 14 more rows</span></span></code></pre></div>
<p><strong>Plot the data!</strong></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, shape <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<p><strong>Add error bars and threshold line:</strong></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, shape <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
        colour <span class="op">=</span> <span class="va">direction</span>,
        ymin <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">-</span> <span class="va">sem</span>,
        ymax <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">+</span> <span class="va">sem</span>
      <span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.02</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>
      yintercept <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data_B</span><span class="op">$</span><span class="va">firing_rate</span><span class="op">)</span>,
      colour <span class="op">=</span> <span class="st">'grey70'</span>,
      linetype <span class="op">=</span> <span class="st">'dashed'</span>
    <span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
<p><strong>Add a line segment indicating points over
threshold:</strong></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, shape <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
        colour <span class="op">=</span> <span class="va">direction</span>,
        ymin <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">-</span> <span class="va">sem</span>,
        ymax <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">+</span> <span class="va">sem</span>
      <span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.02</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>
      yintercept <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data_B</span><span class="op">$</span><span class="va">firing_rate</span><span class="op">)</span>,
      colour <span class="op">=</span> <span class="st">'grey70'</span>,
      linetype <span class="op">=</span> <span class="st">'dashed'</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>
      geom <span class="op">=</span> <span class="st">'segment'</span>,
      x <span class="op">=</span> <span class="fl">1.3</span>,
      xend <span class="op">=</span> <span class="fl">1.78</span>,
      y <span class="op">=</span> <span class="fl">1.2</span>,
      yend <span class="op">=</span> <span class="fl">1.2</span>,
      size <span class="op">=</span> <span class="fl">0.7</span>,
      arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">'both'</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
<p><strong>Set colours, shapes, labels, and themes:</strong></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, shape <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
        colour <span class="op">=</span> <span class="va">direction</span>,
        ymin <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">-</span> <span class="va">sem</span>,
        ymax <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">+</span> <span class="va">sem</span>
      <span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.02</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>
      yintercept <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data_B</span><span class="op">$</span><span class="va">firing_rate</span><span class="op">)</span>,
      colour <span class="op">=</span> <span class="st">'grey70'</span>,
      linetype <span class="op">=</span> <span class="st">'dashed'</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>
      geom <span class="op">=</span> <span class="st">'segment'</span>,
      x <span class="op">=</span> <span class="fl">1.3</span>, xend <span class="op">=</span> <span class="fl">1.78</span>,
      y <span class="op">=</span> <span class="fl">1.2</span>, yend <span class="op">=</span> <span class="fl">1.2</span>,
      size <span class="op">=</span> <span class="fl">0.7</span>,
      arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">'both'</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Normalized\nfiring rate"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="va">theme_548</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
<p><strong>Make the diamonds bigger, reorder layers to emphasize points,
remove x axis title:</strong></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>
      yintercept <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data_B</span><span class="op">$</span><span class="va">firing_rate</span><span class="op">)</span>,
      colour <span class="op">=</span> <span class="st">'grey70'</span>,
      linetype <span class="op">=</span> <span class="st">'dashed'</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
        colour <span class="op">=</span> <span class="va">direction</span>,
        ymin <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">-</span> <span class="va">sem</span>,
        ymax <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">+</span> <span class="va">sem</span>
      <span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.02</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, shape <span class="op">=</span> <span class="va">direction</span>, size <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>
      geom <span class="op">=</span> <span class="st">'segment'</span>,
      x <span class="op">=</span> <span class="fl">1.3</span>, xend <span class="op">=</span> <span class="fl">1.78</span>,
      y <span class="op">=</span> <span class="fl">1.2</span>, yend <span class="op">=</span> <span class="fl">1.2</span>,
      size <span class="op">=</span> <span class="fl">0.7</span>,
      arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">'both'</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Normalized\nfiring rate"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="va">theme_548</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
<p><strong>Add axis lines:</strong></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_B</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>
      yintercept <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data_B</span><span class="op">$</span><span class="va">firing_rate</span><span class="op">)</span>,
      colour <span class="op">=</span> <span class="st">'grey70'</span>,
      linetype <span class="op">=</span> <span class="st">'dashed'</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
        colour <span class="op">=</span> <span class="va">direction</span>,
        ymin <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">-</span> <span class="va">sem</span>,
        ymax <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">+</span> <span class="va">sem</span>
      <span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.02</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, shape <span class="op">=</span> <span class="va">direction</span>, size <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>
      geom <span class="op">=</span> <span class="st">'segment'</span>,
      x <span class="op">=</span> <span class="fl">1.3</span>, xend <span class="op">=</span> <span class="fl">1.78</span>,
      y <span class="op">=</span> <span class="fl">1.2</span>, yend <span class="op">=</span> <span class="fl">1.2</span>,
      size <span class="op">=</span> <span class="fl">0.7</span>,
      arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">'both'</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Normalized\nfiring rate"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="va">theme_548</span> <span class="op">+</span>
    <span class="fu">geom_rangeframe</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
<p><strong>Note the line lengths, y limits, and x breaks are all
wrong</strong><br>
To fudge the lines, let’s make another dataset:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fudge_axis_BC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>speed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">2</span><span class="op">)</span>, firing_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">fudge_axis_BC</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="co">#&gt;   speed firing_rate</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">0.5</span>          -<span style="color: #BB0000;">1</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   2             2</span>

<span class="va">fig_B</span> <span class="op">&lt;-</span> <span class="va">data_B</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Plot data and threshold</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>
      yintercept <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data_B</span><span class="op">$</span><span class="va">firing_rate</span><span class="op">)</span>,
      colour <span class="op">=</span> <span class="st">'grey70'</span>,
      linetype <span class="op">=</span> <span class="st">'dashed'</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
        colour <span class="op">=</span> <span class="va">direction</span>,
        ymin <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">-</span> <span class="va">sem</span>,
        ymax <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">+</span> <span class="va">sem</span>
      <span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.02</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, shape <span class="op">=</span> <span class="va">direction</span>, size <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Annotate points over threshold</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>
      geom <span class="op">=</span> <span class="st">'segment'</span>,
      x <span class="op">=</span> <span class="fl">1.3</span>, xend <span class="op">=</span> <span class="fl">1.78</span>,
      y <span class="op">=</span> <span class="fl">1.2</span>, yend <span class="op">=</span> <span class="fl">1.2</span>,
      size <span class="op">=</span> <span class="fl">0.7</span>,
      arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">'both'</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="co"># Select colours and shapes</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Text</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Normalized\nfiring rate"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Theme</span>
    <span class="va">theme_548</span> <span class="op">+</span>
    <span class="co"># Axes</span>
    <span class="fu">geom_rangeframe</span><span class="op">(</span>data <span class="op">=</span> <span class="va">fudge_axis_BC</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">fig_B</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-49-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="build-another-grouped-barplot-figure-3-panel-f">Build another grouped barplot (Figure 3 Panel F):<a class="anchor" aria-label="anchor" href="#build-another-grouped-barplot-figure-3-panel-f"></a>
</h2>
<p><strong>Visualize data:</strong></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3F_data.csv"</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">240</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">33</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (33): bird, trk, site, cell, pd.sum, species, test.dir1, dir1.area, test...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 240 × 33</span></span>
<span class="co">#&gt;     bird   trk  site  cell pd.sum species test.dir1 dir1.area test.dir2</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   194     1  <span style="text-decoration: underline;">3</span>007     1   11.1       2         0      25.1       180</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   194     1  <span style="text-decoration: underline;">3</span>007     2  343.        2         0      41.4       180</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   194     1  <span style="text-decoration: underline;">3</span>062     1  298.        2        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   194     1  <span style="text-decoration: underline;">3</span>062     2  358.        2         0      46.9       180</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   194     1  <span style="text-decoration: underline;">3</span>062     3  287.        2        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   194     3  <span style="text-decoration: underline;">3</span>459     3  188.        2        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   194     5  <span style="text-decoration: underline;">3</span>516     1  117.        2       135      20.9       315</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   194     5  <span style="text-decoration: underline;">3</span>516     2  176.        2       135      20.2       315</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   194     5  <span style="text-decoration: underline;">3</span>516     3  192.        2        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   194     5  <span style="text-decoration: underline;">3</span>516     4  155.        2        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 230 more rows, and 24 more variables: dir2.area &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   pref.speed &lt;dbl&gt;, sp80.1 &lt;dbl&gt;, sp80.2 &lt;dbl&gt;, sp80.3 &lt;dbl&gt;, sp80.4 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   sp80.5 &lt;dbl&gt;, sp80.6 &lt;dbl&gt;, sp80.7 &lt;dbl&gt;, sp80.8 &lt;dbl&gt;, sp80.9 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   sp80.10 &lt;dbl&gt;, sp80.11 &lt;dbl&gt;, sp80.12 &lt;dbl&gt;, tune50 &lt;dbl&gt;, tune55 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   tune60 &lt;dbl&gt;, tune65 &lt;dbl&gt;, tune70 &lt;dbl&gt;, tune75 &lt;dbl&gt;, tune80 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   tune85 &lt;dbl&gt;, tune90 &lt;dbl&gt;, tune95 &lt;dbl&gt;</span></span>
<span class="va">speeds_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.24</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">8</span>,<span class="fl">16</span>,<span class="fl">24</span>,<span class="fl">32</span>,<span class="fl">48</span>,<span class="fl">64</span>,<span class="fl">80</span><span class="op">)</span></code></pre></div>
<p><strong>Remove any rows without data (dir1.area is NA):</strong></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3F_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dir1.area</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">240</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">33</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (33): bird, trk, site, cell, pd.sum, species, test.dir1, dir1.area, test...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 163 × 33</span></span>
<span class="co">#&gt;     bird   trk  site  cell pd.sum species test.dir1 dir1.area test.dir2</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   194     1  <span style="text-decoration: underline;">3</span>007     1   11.1       2         0     25.1        180</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   194     1  <span style="text-decoration: underline;">3</span>007     2  343.        2         0     41.4        180</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   194     1  <span style="text-decoration: underline;">3</span>062     2  358.        2         0     46.9        180</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   194     5  <span style="text-decoration: underline;">3</span>516     1  117.        2       135     20.9        315</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   194     5  <span style="text-decoration: underline;">3</span>516     2  176.        2       135     20.2        315</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   198     3  <span style="text-decoration: underline;">2</span>990     1  320.        2       315    -<span style="color: #BB0000;">12.9</span>        135</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   198     3  <span style="text-decoration: underline;">2</span>990     2  340.        2       315     30.4        135</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   198     5  <span style="text-decoration: underline;">3</span>345     2  147.        2       135     -<span style="color: #BB0000;">2.81</span>       315</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   198     5  <span style="text-decoration: underline;">3</span>345     3  141.        2       135    -<span style="color: #BB0000;">22.7</span>        315</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   199     1  <span style="text-decoration: underline;">2</span>383     1   92.4       2        90      1.67       270</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 153 more rows, and 24 more variables: dir2.area &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   pref.speed &lt;dbl&gt;, sp80.1 &lt;dbl&gt;, sp80.2 &lt;dbl&gt;, sp80.3 &lt;dbl&gt;, sp80.4 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   sp80.5 &lt;dbl&gt;, sp80.6 &lt;dbl&gt;, sp80.7 &lt;dbl&gt;, sp80.8 &lt;dbl&gt;, sp80.9 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   sp80.10 &lt;dbl&gt;, sp80.11 &lt;dbl&gt;, sp80.12 &lt;dbl&gt;, tune50 &lt;dbl&gt;, tune55 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   tune60 &lt;dbl&gt;, tune65 &lt;dbl&gt;, tune70 &lt;dbl&gt;, tune75 &lt;dbl&gt;, tune80 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   tune85 &lt;dbl&gt;, tune90 &lt;dbl&gt;, tune95 &lt;dbl&gt;</span></span></code></pre></div>
<p><strong>Remove unnecessary columns:</strong></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3F_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dir1.area</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sp"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">240</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">33</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (33): bird, trk, site, cell, pd.sum, species, test.dir1, dir1.area, test...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 163 × 13</span></span>
<span class="co">#&gt;    species sp80.1 sp80.2 sp80.3 sp80.4 sp80.5 sp80.6 sp80.7 sp80.8 sp80.9</span>
<span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       2      0      0      0      0      0      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2      0      0      0      0      0      0      0      0      1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       2      0      0      0      0      0      0      0      0      1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       2      0      0      0      0      0      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       2      0      0      0      0      1      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       2      0      0      0      1      0      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       2      0      0      0      0      0      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       2      0      0      0      0      0      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       2      1      0      0      0      0      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       2      0      1      0      0      0      0      0      0      0</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 153 more rows, and 3 more variables: sp80.10 &lt;dbl&gt;, sp80.11 &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   sp80.12 &lt;dbl&gt;</span></span></code></pre></div>
<p><strong>Rename columns using speeds_F, change species to
words:</strong></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3F_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dir1.area</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sp"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>,<span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speeds_F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    species <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
      <span class="va">species</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"zb"</span>,
      <span class="va">species</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"hb"</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">240</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">33</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (33): bird, trk, site, cell, pd.sum, species, test.dir1, dir1.area, test...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 163 × 13</span></span>
<span class="co">#&gt;    species `0.24` `0.5`   `1`   `2`   `4`   `8`  `16`  `24`  `32`  `48`  `64`</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hb           0     0     0     0     0     0     0     0     0     1     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hb           0     0     0     0     0     0     0     0     1     1     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hb           0     0     0     0     0     0     0     0     1     0     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hb           0     0     0     0     0     0     0     0     0     1     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hb           0     0     0     0     1     0     0     0     0     1     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hb           0     0     0     1     0     0     0     0     0     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hb           0     0     0     0     0     0     0     0     0     0     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hb           0     0     0     0     0     0     0     0     0     0     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hb           1     0     0     0     0     0     0     0     0     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hb           0     1     0     0     0     0     0     0     0     0     0</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 153 more rows, and 1 more variable: 80 &lt;dbl&gt;</span></span></code></pre></div>
<p><strong>Reshape data for plotting:</strong></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3F_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dir1.area</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sp"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>,<span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speeds_F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    species <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
      <span class="va">species</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"zb"</span>,
      <span class="va">species</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"hb"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">speed</span>, value <span class="op">=</span> <span class="va">prop</span>, <span class="op">-</span><span class="va">species</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">240</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">33</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (33): bird, trk, site, cell, pd.sum, species, test.dir1, dir1.area, test...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,956 × 3</span></span>
<span class="co">#&gt;    species speed  prop</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hb      0.24      1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hb      0.24      0</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1,946 more rows</span></span></code></pre></div>
<p><strong>Summarize proporions by species and speed:</strong></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3F_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dir1.area</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sp"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>,<span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speeds_F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    species <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
      <span class="va">species</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"zb"</span>,
      <span class="va">species</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"hb"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">speed</span>, value <span class="op">=</span> <span class="va">prop</span>, <span class="op">-</span><span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="va">ungroup</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">240</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">33</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (33): bird, trk, site, cell, pd.sum, species, test.dir1, dir1.area, test...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; `summarise()` has grouped output by 'species'. You can override using the `.groups` argument.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 3</span></span>
<span class="co">#&gt;    species speed   prop</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hb      0.24  0.035<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hb      0.5   0.017<span style="text-decoration: underline;">9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hb      1     0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hb      16    0.143 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hb      2     0.125 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hb      24    0.232 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hb      32    0.339 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hb      4     0.035<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hb      48    0.446 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hb      64    0.5   </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 14 more rows</span></span></code></pre></div>
<p><strong>Finally fix the factor levels as before:</strong></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3F_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dir1.area</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sp"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>,<span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speeds_F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    species <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
      <span class="va">species</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"zb"</span>,
      <span class="va">species</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"hb"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">speed</span>, value <span class="op">=</span> <span class="va">prop</span>, <span class="op">-</span><span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="va">ungroup</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    species <span class="op">=</span> <span class="fu">fct_relevel</span><span class="op">(</span><span class="va">species</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'hb'</span>, <span class="st">'zb'</span><span class="op">)</span><span class="op">)</span>,
    speed <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">240</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">33</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (33): bird, trk, site, cell, pd.sum, species, test.dir1, dir1.area, test...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; `summarise()` has grouped output by 'species'. You can override using the `.groups` argument.</span>
<span class="va">data_F</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 3</span></span>
<span class="co">#&gt;    species speed   prop</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hb      0.24  0.035<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hb      0.5   0.017<span style="text-decoration: underline;">9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hb      1     0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hb      16    0.143 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hb      2     0.125 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hb      24    0.232 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hb      32    0.339 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hb      4     0.035<span style="text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hb      48    0.446 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hb      64    0.5   </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 14 more rows</span></span></code></pre></div>
<p><strong>Plot data as before:</strong></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_F</span> <span class="op">&lt;-</span> <span class="va">data_F</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">prop</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Plot data</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>
      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.75</span>,
      size <span class="op">=</span> <span class="fl">0.2</span>,
      colour <span class="op">=</span> <span class="st">"black"</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="co"># Pick colours</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col_hb</span>, <span class="va">col_zb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Text</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"Speed bins (degrees/s)"</span>,
      y <span class="op">=</span> <span class="st">"Proportion of LM\ncell population"</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="co"># Theme</span>
    <span class="va">theme_548</span> <span class="op">+</span>
    <span class="co"># Axes</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
      axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
      axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_rangeframe</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span>
<span class="va">fig_F</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-57-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="build-another-line-plot-figure-3-panel-c">Build another line plot (Figure 3 Panel C):<a class="anchor" aria-label="anchor" href="#build-another-line-plot-figure-3-panel-c"></a>
</h2>
<p><strong>Reorganize raw data:</strong></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_C_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"Fig3C_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">bin</span>, value <span class="op">=</span> <span class="va">count</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bin"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trial</span>, <span class="va">direction</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    raw_firing_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">239</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">23</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (23): trial, direction, speed, bin1, bin2, bin3, bin4, bin5, bin6, bin7,...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; `summarise()` has grouped output by 'trial', 'direction'. You can override using the `.groups` argument.</span>
<span class="va">data_C_raw</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 239 × 4</span></span>
<span class="co">#&gt;    trial direction   speed raw_firing_rate</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       180   0.821            7.99</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                5.20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3         0   1.30            24.8 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                2.80</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5       180   1.77             3.00</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                4.00</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7         0   0.214           14.8 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                2.80</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9       180   1.63             3.00</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10       <span style="color: #BB0000;">NaN</span> <span style="color: #BB0000;">NaN</span>                4.60</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 229 more rows</span></span></code></pre></div>
<p><strong>Calculate baseline:</strong></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">baseline</span> <span class="op">&lt;-</span> <span class="va">data_C_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">==</span> <span class="st">'NaN'</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">raw_firing_rate</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="va">mean</span>
<span class="va">baseline</span>
<span class="co">#&gt; [1] 3.852074</span></code></pre></div>
<p><strong>Normalize data and calculate mean, SE:</strong></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_C</span> <span class="op">&lt;-</span> <span class="va">data_C_raw</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">!=</span> <span class="st">'NaN'</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    norm_firing_rate <span class="op">=</span> <span class="va">raw_firing_rate</span> <span class="op">-</span> <span class="va">baseline</span>,
    norm_firing_rate <span class="op">=</span> <span class="va">norm_firing_rate</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">direction</span>, <span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    firing_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span>,
    sem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">norm_firing_rate</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">direction</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'direction'. You can override using the</span>
<span class="co">#&gt; `.groups` argument.</span>
<span class="va">data_C</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 4</span></span>
<span class="co">#&gt;    direction   speed firing_rate     sem</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0         -<span style="color: #BB0000;">0.696</span>      -<span style="color: #BB0000;">0.010</span><span style="color: #BB0000; text-decoration: underline;">9</span> 0.016<span style="text-decoration: underline;">4</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0         -<span style="color: #BB0000;">0.401</span>       0.013<span style="text-decoration: underline;">3</span> 0.003<span style="text-decoration: underline;">24</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 0         -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">7</span>      0.138  0.056<span style="text-decoration: underline;">1</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 0          0.214       0.475  0.100  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 0          0.524       0.734  0.050<span style="text-decoration: underline;">0</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 0          0.821       0.872  0.044<span style="text-decoration: underline;">3</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 0          1.13        0.810  0.079<span style="text-decoration: underline;">4</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 0          1.30        0.746  0.050<span style="text-decoration: underline;">7</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 0          1.43        0.811  0.045<span style="text-decoration: underline;">2</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 0          1.63        0.772  0.079<span style="text-decoration: underline;">6</span> </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 14 more rows</span></span></code></pre></div>
<p><strong>Plot data:</strong></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig_C</span> <span class="op">&lt;-</span> <span class="va">data_C</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">speed</span>, y <span class="op">=</span> <span class="va">firing_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Plot data and threshold</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>
      yintercept <span class="op">=</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data_C</span><span class="op">$</span><span class="va">firing_rate</span><span class="op">)</span>,
      colour <span class="op">=</span> <span class="st">'grey70'</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>
        colour <span class="op">=</span> <span class="va">direction</span>,
        ymin <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">-</span> <span class="va">sem</span>,
        ymax <span class="op">=</span> <span class="va">firing_rate</span> <span class="op">+</span> <span class="va">sem</span>
      <span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.02</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">direction</span>, 
                   shape <span class="op">=</span> <span class="va">direction</span>, 
                   size <span class="op">=</span> <span class="va">direction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Annotate points over threshold</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>
      geom <span class="op">=</span> <span class="st">"segment"</span>,
      x <span class="op">=</span> <span class="fl">0.5</span>, xend <span class="op">=</span> <span class="fl">1.9</span>,
      y <span class="op">=</span> <span class="fl">1.2</span>, yend <span class="op">=</span> <span class="fl">1.2</span>,
      size <span class="op">=</span> <span class="fl">0.7</span>,
      arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">'both'</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="co"># Select colours and shapes</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Text</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Normalized\nfiring rate"</span>, x <span class="op">=</span> <span class="st">"log(degrees/s)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="co">#theme(axis.title.x = element_blank()) +</span>
    <span class="co"># Theme</span>
    <span class="va">theme_548</span> <span class="op">+</span>
    <span class="co"># Axes</span>
    <span class="fu">geom_rangeframe</span><span class="op">(</span>data <span class="op">=</span> <span class="va">fudge_axis_BC</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">fig_C</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/unnamed-chunk-61-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="build-a-connected-line-plot-figure-3-panel-a">Build a connected-line plot (Figure 3 Panel A):<a class="anchor" aria-label="anchor" href="#build-a-connected-line-plot-figure-3-panel-a"></a>
</h2>
<p>Panel A is a bit complicated, so we’ll just provide the full code
here</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First, import data</span>
<span class="va">fig_A</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"./Fig3A_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># Now take every nth data point (produces plot faster)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">5</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># Clean outliers</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">spike</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">7</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">spike</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://tidyr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">spike</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Y-axis vertical scale</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>,
             y <span class="op">=</span> <span class="fl">0.00278</span> <span class="op">-</span> <span class="fl">0.01</span>, yend <span class="op">=</span> <span class="fl">0.00278</span> <span class="op">+</span> <span class="fl">0.01</span>,
             x <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, xend <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>,
             lwd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Y-axis scale label</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, y <span class="op">=</span> <span class="fl">0.00278</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>,
             label <span class="op">=</span> <span class="st">"0.2 mV"</span>, size <span class="op">=</span> <span class="fl">5</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># X-axis scale bar</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>,
             y <span class="op">=</span> <span class="op">-</span><span class="fl">0.035</span>, yend <span class="op">=</span> <span class="op">-</span><span class="fl">0.035</span>,
             x <span class="op">=</span> <span class="fl">70</span> <span class="op">+</span> <span class="fl">1.5</span>, xend <span class="op">=</span> <span class="fl">75</span> <span class="op">+</span> <span class="fl">1.5</span>,
             lwd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># X-axis scale label</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.04</span>, x <span class="op">=</span> <span class="fl">74</span>,
             label <span class="op">=</span> <span class="st">"5s"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Large ticks</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>,
             y <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span>, yend <span class="op">=</span> <span class="op">-</span><span class="fl">0.025</span>,
             x <span class="op">=</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span> <span class="op">*</span> <span class="fl">5</span>, xend <span class="op">=</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span> <span class="op">*</span> <span class="fl">5</span>,
             lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Small ticks within large ticks</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>,
             y <span class="op">=</span> <span class="op">-</span><span class="fl">0.027</span>, yend <span class="op">=</span> <span class="op">-</span><span class="fl">0.028</span>,
             x <span class="op">=</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">79</span>, xend <span class="op">=</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">79</span>,
             lwd <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
    <span class="co"># Arrows</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>
      geom <span class="op">=</span> <span class="st">"segment"</span>,
      y <span class="op">=</span> <span class="op">-</span><span class="fl">0.0275</span>,
      yend <span class="op">=</span> <span class="op">-</span><span class="fl">0.0275</span>,
      x <span class="op">=</span> <span class="op">-</span><span class="fl">10</span> <span class="op">+</span> <span class="fl">2.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span> <span class="op">*</span> <span class="fl">10</span>,
      xend <span class="op">=</span> <span class="op">-</span><span class="fl">10</span> <span class="op">+</span> <span class="fl">5.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span> <span class="op">*</span> <span class="fl">10</span>,
      lwd <span class="op">=</span> <span class="fl">1.2</span>,
      arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>
        <span class="co"># Control the direction of each arrow. first = left; last = right</span>
        ends <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first"</span>, <span class="st">"last"</span>, <span class="st">"last"</span>, <span class="st">"last"</span>,
                 <span class="st">"first"</span>, <span class="st">"first"</span>, <span class="st">"first"</span>, <span class="st">"last"</span><span class="op">)</span>,
        <span class="co"># Control the size of each arrow head</span>
        length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"pt"</span><span class="op">)</span>,
        type <span class="op">=</span> <span class="st">"closed"</span>
        <span class="op">)</span>,
      <span class="co"># Use 'sharp' arrow heads</span>
      linejoin <span class="op">=</span> <span class="st">'mitre'</span><span class="op">)</span>
<span class="va">fig_A</span></code></pre></div>
<p><img src="group-02_Piping-single-panel-ggplot-figs_files/figure-html/panel_A-1.png" width="700"></p>
<div class="section level3">
<h3 id="congratulations-you-finished-part-2">Congratulations! You finished part 2!!<a class="anchor" aria-label="anchor" href="#congratulations-you-finished-part-2"></a>
</h3>
<p>Now check out <a href="https://flightlab.github.io/MultiPanelPlotsWithR/articles/group-03_Using-cowplot-multi-panel.html">part
3</a></p>
<p>🐢</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.vikram-baliga.com/" class="external-link">Vikram B.
Baliga</a>, <a href="https://www.andreagaede.com/" class="external-link">Andrea Gaede</a>,
<a href="https://www.zoology.ubc.ca/person/shreeram-senthivasan/" class="external-link">Shree
Senthivasan</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
